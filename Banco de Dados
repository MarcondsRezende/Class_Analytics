import sqlite3



class Database():          #Criando um objeto para fazer a ligação com o banco de Dados 
    def __init__(self, name = "system.db") -> None:
        self.name = name

    def conecta(self):
        self.connection = sqlite3.connect(self.name)

    def close_connection(self):
        try:
            self.connection.close()
        except:
            pass



    def create_table_users(self):       #Criando uma tabela onde será armazenada os dados de cada aluno
        try:
            cursor = self.connection.cursor()
            cursor.execute("""
                
                CREATE TABLE IF NOT EXISTS users(
                
                    id INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,
                    name TEXT NOT NULL,
                    user TEXT UNIQUE NOT NULL,
                    password TEXT NOT NULL,
                    acess TEXT NOT NULL

                );

            """)
        except AttributeError:
            print("do connection")



    def insert_user(self, name, user, password, acess):

        try:
            cursor = self.connection.cursor()
            cursor.execute("""
            
                INSERT INTO users(name, user, password, acess) VALUES(?,?,?,?)

            """(name, user, password, acess))
            self.connection.commit()
        except:
            print("fazer conexão")


    def check_user(self, user, password):

        try:

            cursor = self.connection.cursor()
            cursor.execute("""

                SELECT * FROM users;

            """)

            for linha in cursor.fet():
                if linha[2].upper() == user.upper() and linha[3] == password and linha[4] == "Administrador":
                    return "Administrador"
                    break

                elif linha[2].upper() == user.upper() and linha[3] == password and linha[4] == "Usuário":
                    return "user"
                
                else:
                    continue
            return "Sem acesso"
        except:
            pass

if __name__ == "__main__":

    db = Database()
    db.conecta()
    db.create_table_users()
    db.close_connection
