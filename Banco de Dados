import sqlite3


#Criando um objeto para fazer a ligação com o banco de Dados 
class Database():          
    def __init__(self, name = "dataframe.db") -> None:                  #iniciando o banco de dados
        self.name = name

    def conecta(self):                      #criando uma def que acessa o banco de dados
        self.connection = sqlite3.connect(self.name) 

    def close_connection(self):             #fechando a conexão ao banco de dados
        try:                                #tentar fechar (caso tenha erro)
            self.connection.close()
        except:
            pass                            #caso der o erro passar



    def create_table_users(self):       #Criando uma tabela onde será armazenada os dados de cada aluno
        try:
            cursor = self.connection.cursor()
            cursor.execute("""
                
                CREATE TABLE IF NOT EXISTS users(
                
                    id INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,
                    name TEXT NOT NULL,
                    nota_1 TEXT NOT NULL,
                    nota_2 TEXT NOT NULL,
                    nota_3 TEXT NOT NULL,

                );

            """)
        except AttributeError:
            print("faça conexão")

if __name__ == "__main__":

    db = Database()
    db.conecta()
    db.create_table_users()
    db.close_connection


    def insert_user(self, name, nota_1, nota_2, nota_3,acess):             #criando o

        try:
            cursor = self.connection.cursor()
            cursor.execute("""
            
            INSERT INTO users(name, user, password, acess) VALUES(?,?,?,?)

        """(name, user, password, acess))
            self.connection.commit()
        except:
            print("fazer conexão")
